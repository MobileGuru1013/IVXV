{#

IVXV Internet voting framework

Template file for rsyslog config in service host.

-#}
# IVXV Internet voting framework

# Rsyslog logging configuration file
# {{ config_filepath }}

# This file is automatically generated
# by collector management service! DO NOT CHANGE!

# load RELP output module
module(load="omrelp")


# LOCAL LOGGING

# write IVXV log to /var/log/ivxv.log (up to level INFO)
if ($programname startswith 'ivxv-') then action(
    type="omfile"
    file="/var/log/ivxv.log"
    template="ivxv-json"
)

# write IVXV debug log and log of related
# services (haproxy, rsyslog, sshd) to /var/log/ivxv-debug.log
if ($programname startswith 'ivxv-') or ($programname startswith 'rsyslog') or
   ($programname == 'haproxy') or ($programname == 'sshd') then
action(
    type="omfile"
    file="/var/log/ivxv-debug.log"
)


# REMOTE LOGGING - log collector services
{% for log_collector in log_collectors %}
# forward log messages to log collector "{{ log_collector.id }}" using RELP protocol
action(
    type="omrelp"
    target="{{ log_collector.address }}"
    port="{{ log_collector.port }}"
)
{% else %}
# --- no log collectors defined ---
{% endfor %}

# REMOTE LOGGING - log monitoring service
{% if log_monitor %}
# forward log messages to log monitor using {{ log_monitor.protocol|upper }} protocol
if ($programname startswith 'ivxv-') and ($syslogseverity <= '6') then
action(
    type="omfwd"
    target="{{ log_monitor.address }}"
    port="{{ log_monitor.port }}"
    protocol="{{ log_monitor.protocol }}"
)
{% else %}
# --- no log montitors defined ---
{% endif %}
{#-
vim:set syntax=jinja:
#}
